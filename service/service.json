[
    {
        "name": "awxweb",
        "image": "sblack4/awx_web:latest",
        "hostname": "awxweb",
        "links": [
            "awx:awx",
            "rabbitmq:rabbitmq",
            "memcached:memcached"
        ],
        "user": "root",
        "essential": true,
        "memory": 1024,
        "portMappings": [
            {
                "containerPort": 8052,
                "hostPort": 80
            }
        ],
        "environment": [
            {
                "name": "DATABASE_USER",
                "value": "${ database_username }"
            }, 
            {
                "name": "DATABASE_HOST",
                "value": "${ database_host }"
            },
            {
                "name": "AWX_ADMIN_USER",
                "valueFrom": "${ awx_admin_username }"
            }
        ],
        "secrets": [
            {
                "name": "DATABASE_PASSWORD",
                "valueFrom": "${ database_password_arn }"
            },
            {
                "name": "SECRET_KEY",
                "valueFrom": "${ awx_secret_key }"
            }, 
            {
                "name": "AWX_ADMIN_PASSWORD",
                "valueFrom": "${ awx_admin_password }"
            }
        ]
    },
    {
        "name": "awx",
        "image": "sblack4/awx_task:latest",
        "hostname": "awx",
        "links": [
            "rabbitmq:rabbitmq",
            "memcached:memcached"
        ],
        "user": "root",
        "essential": true,
        "cpu": 2048,
        "memory": 2000,
        "portMappings": [
            {
                "containerPort": 8052
            }
        ],
        "environment": [
            {
                "name": "DATABASE_USER",
                "value": "${ database_username }"
            }, 
            {
                "name": "DATABASE_HOST",
                "value": "${ database_host }"
            },
            {
                "name": "AWX_ADMIN_USER",
                "valueFrom": "${ awx_admin_username }"
            }
        ],
        "secrets": [
            {
                "name": "DATABASE_PASSWORD",
                "valueFrom": "${ database_password_arn }"
            },
            {
                "name": "SECRET_KEY",
                "valueFrom": "${ awx_secret_key }"
            }, 
            {
                "name": "AWX_ADMIN_PASSWORD",
                "valueFrom": "${ awx_admin_password }"
            }
        ]
    },
    {
        "name": "rabbitmq",
        "image": "ansible/awx_rabbitmq:3.7.4",
        "hostname": "rabbitmq",
        "essential": true,
        "memory": 1024,
        "portMappings": [
            {
                "containerPort": 5672
            }
        ],
        "environment": [
            {
                "name": "RABBITMQ_DEFAULT_VHOST",
                "value": "awx"
            },
            {
                "name": "RABBITMQ_DEFAULT_USER",
                "value": "guest"
            },
            {
                "name": "RABBITMQ_DEFAULT_PASS",
                "value": "awxpass"
            },
            {
                "name": "RABBITMQ_ERLANG_COOKIE",
                "value": "cookiemonster"
            }
        ]
    },
    {
        "name": "memcached",
        "image": "memcached:alpine",
        "hostname": "memcached",
        "essential": true,
        "memory": 2048,
        "portMappings": [
            {
                "containerPort": 11211
            }
        ]
    }
]